2021-04-01 18:07:17,751 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 18:07:19,216 - ### Model summary below###
 CPAELSTM44(
  (lstm1): LSTM(76, 256, batch_first=True)
  (lstm2): LSTM(256, 256, batch_first=True)
  (lstm3): LSTM(256, 256, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=256, out_features=256, bias=True)
  )
  (lstm4): LSTM(256, 76, batch_first=True)
)

2021-04-01 18:07:19,216 - ===> Model total parameter: 1627808

2021-04-01 18:07:19,216 - {'data_split': 'benchmark', 'batch_size': 48, 'n_points': 192, 'n_features': 76, 'time_step': 30, 'mode': 0, 'points_per_hour': 4, 'frame_size': 16, 'n_frames': 12, 'dim': 256, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.0003, 'epochs': 2000, 'seed': 1, 'log_interval': 30, 'num_workers': 30, 'gru_out': 256, 'optimizer': 'optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), lr=0.0003, betas=(0.9, 0.98), eps=1e-09,weight_decay=1e-4)', 'model_params': None, 'setting_name': 'st_lr_3e-4_ts30_cos_t0.5', 'run_name': 'st_lr_3e-4_ts30_cos_t0.5-2021-04-01_18_07_17', 'model_type': 'CPAELSTM44', 'resume': False, 'model_best': 'st_lr_3e-4_ts30_cos_t0.5-2021-04-01_17_54_23-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4_ts30_cos_t0.5.ini', 'updated_lr': 0.0003, 'sim': 'cosine', 'temperature': 0.5, 'adjust_lr': True}
2021-04-01 18:07:19,216 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 18:07:19,216 - weights are [1, 1, 1, 3]
2021-04-01 18:07:24,249 - 	 20.15759 0.00030
2021-04-01 18:08:16,874 - 	 19.52246 0.00030
2021-04-01 18:09:07,956 - 	 19.26519 0.00030
2021-04-01 18:10:00,031 - 	 18.83209 0.00030
2021-04-01 18:10:02,588 - 
 ---------------------- mean loss : 20.85395  ---------------------- 

2021-04-01 18:10:02,589 - Starting Validation
2021-04-01 18:10:22,916 - 
                     ------- validation -------            

2021-04-01 18:10:22,916 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 18:10:22,916 - 	 3.6363  	 0.1872  	 0.0783 	 0.5572
2021-04-01 18:10:22,916 - -------------------------------
Validation Epoch: 1 	Accuracy: 136.0000	Loss: 1335.520301
------------------
2021-04-01 18:10:22,932 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4_ts30_cos_t0.5-2021-04-01_18_07_17-model_best.pth

2021-04-01 18:10:22,933 - Best model updated in 'st_lr_3e-4_ts30_cos_t0.5.ini'! !!!!!!!!!
2021-04-01 18:10:22,933 - #### End epoch 1/2000, elapsed time: 183.7166061522439
2021-04-01 18:10:22,933 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 18:10:22,933 - weights are [1, 1, 1, 3]
2021-04-01 18:10:27,051 - 	 18.79630 0.00030
2021-04-01 18:11:20,874 - 	 19.85348 0.00030
2021-04-01 18:12:12,841 - 	 18.74664 0.00030
2021-04-01 18:13:04,137 - 	 18.80909 0.00030
2021-04-01 18:13:06,759 - 
 ---------------------- mean loss : 20.12541  ---------------------- 

2021-04-01 18:13:06,759 - Starting Validation
2021-04-01 18:13:26,692 - 
                     ------- validation -------            

2021-04-01 18:13:26,692 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 18:13:26,692 - 	 3.6356  	 0.1352  	 0.0331 	 0.3905
2021-04-01 18:13:26,692 - -------------------------------
Validation Epoch: 2 	Accuracy: 136.0000	Loss: 1302.889379
------------------
2021-04-01 18:13:26,693 - #### End epoch 2/2000, elapsed time: 183.7595983883366
2021-04-01 18:13:26,693 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 18:13:26,693 - weights are [1, 1, 1, 3]
2021-04-01 18:13:31,337 - 	 18.64477 0.00030
2021-04-01 18:14:23,380 - 	 18.62186 0.00030
2021-04-01 18:15:14,436 - 	 18.59271 0.00030
2021-04-01 18:16:05,654 - 	 18.53905 0.00030
2021-04-01 18:16:08,346 - 
 ---------------------- mean loss : 20.01300  ---------------------- 

2021-04-01 18:16:08,347 - Starting Validation
2021-04-01 18:16:28,241 - 
                     ------- validation -------            

2021-04-01 18:16:28,241 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 18:16:28,241 - 	 3.6359  	 0.1777  	 0.0251 	 0.6126
2021-04-01 18:16:28,241 - -------------------------------
Validation Epoch: 3 	Accuracy: 136.0000	Loss: 1335.035159
------------------
2021-04-01 18:16:28,241 - #### End epoch 3/2000, elapsed time: 181.5487511958927
2021-04-01 18:16:28,242 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 18:16:28,242 - weights are [1, 1, 1, 3]
2021-04-01 18:16:32,388 - 	 18.65192 0.00030
2021-04-01 18:17:28,196 - 	 18.55479 0.00030
