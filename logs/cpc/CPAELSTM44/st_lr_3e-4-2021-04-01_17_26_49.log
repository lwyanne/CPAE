2021-04-01 17:26:49,876 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 17:26:51,236 - ### Model summary below###
 CPAELSTM44(
  (lstm1): LSTM(76, 256, batch_first=True)
  (lstm2): LSTM(256, 256, batch_first=True)
  (lstm3): LSTM(256, 256, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=256, out_features=256, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=256, out_features=256, bias=True)
  )
  (lstm4): LSTM(256, 76, batch_first=True)
)

2021-04-01 17:26:51,237 - ===> Model total parameter: 1627808

2021-04-01 17:26:51,244 - {'data_split': 'benchmark', 'batch_size': 48, 'n_points': 192, 'n_features': 76, 'time_step': 30, 'mode': 0, 'points_per_hour': 4, 'frame_size': 16, 'n_frames': 12, 'dim': 256, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.0003, 'epochs': 1000, 'seed': 1, 'log_interval': 30, 'num_workers': 30, 'gru_out': 256, 'optimizer': 'optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), lr=0.0003, betas=(0.9, 0.98), eps=1e-09,weight_decay=1e-4)', 'model_params': None, 'setting_name': 'st_lr_3e-4', 'run_name': 'st_lr_3e-4-2021-04-01_17_26_49', 'model_type': 'CPAELSTM44', 'resume': False, 'model_best': 'st_lr_3e-4-2021-04-01_11_08_29-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4.ini', 'updated_lr': 0.0003, 'adjust_lr': True}
2021-04-01 17:26:51,244 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 17:26:51,244 - weights are [1, 1, 1, 3]
2021-04-01 17:26:54,373 - 	 20.57430 0.00030
2021-04-01 17:27:25,036 - 	 17.01512 0.00030
2021-04-01 17:27:54,816 - 	 16.73662 0.00030
2021-04-01 17:28:25,608 - 	 15.73217 0.00030
2021-04-01 17:28:27,094 - 
 ---------------------- mean loss : 19.11708  ---------------------- 

2021-04-01 17:28:27,094 - Starting Validation
2021-04-01 17:28:43,029 - 
                     ------- validation -------            

2021-04-01 17:28:43,030 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:28:43,030 - 	 2.8026  	 0.1827  	 0.1001 	 0.4834
2021-04-01 17:28:43,030 - -------------------------------
Validation Epoch: 1 	Accuracy: 355.0000	Loss: 1044.669444
------------------
2021-04-01 17:28:43,045 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:28:43,045 - Best model updated in 'st_lr_3e-4.ini'! !!!!!!!!!
2021-04-01 17:28:43,045 - #### End epoch 1/1000, elapsed time: 111.80117176473141
2021-04-01 17:28:43,045 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 17:28:43,045 - weights are [1, 1, 1, 3]
2021-04-01 17:28:46,073 - 	 15.10752 0.00030
2021-04-01 17:29:16,749 - 	 14.39646 0.00030
2021-04-01 17:29:48,520 - 	 13.38718 0.00030
2021-04-01 17:30:17,890 - 	 13.92642 0.00030
2021-04-01 17:30:19,382 - 
 ---------------------- mean loss : 16.64879  ---------------------- 

2021-04-01 17:30:19,382 - Starting Validation
2021-04-01 17:30:35,662 - 
                     ------- validation -------            

2021-04-01 17:30:35,663 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:30:35,663 - 	 2.5544  	 0.2801  	 0.0997 	 0.9424
2021-04-01 17:30:35,663 - -------------------------------
Validation Epoch: 2 	Accuracy: 406.0000	Loss: 1029.254573
------------------
2021-04-01 17:30:35,695 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:30:35,696 - Best model updated in 'st_lr_3e-4.ini'! !!!!!!!!!
2021-04-01 17:30:35,696 - #### End epoch 2/1000, elapsed time: 112.650919101201
2021-04-01 17:30:35,696 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 17:30:35,696 - weights are [1, 1, 1, 3]
2021-04-01 17:30:38,344 - 	 13.94607 0.00030
2021-04-01 17:31:09,669 - 	 15.13000 0.00030
2021-04-01 17:31:39,791 - 	 14.43536 0.00030
2021-04-01 17:32:09,166 - 	 14.06437 0.00030
2021-04-01 17:32:10,704 - 
 ---------------------- mean loss : 14.96014  ---------------------- 

2021-04-01 17:32:10,705 - Starting Validation
2021-04-01 17:32:26,617 - 
                     ------- validation -------            

2021-04-01 17:32:26,617 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:32:26,617 - 	 2.3250  	 0.1744  	 0.0973 	 0.4999
2021-04-01 17:32:26,617 - -------------------------------
Validation Epoch: 3 	Accuracy: 758.0000	Loss: 883.574444
------------------
2021-04-01 17:32:26,649 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:32:26,650 - Best model updated in 'st_lr_3e-4.ini'! !!!!!!!!!
2021-04-01 17:32:26,650 - #### End epoch 3/1000, elapsed time: 110.95347472000867
2021-04-01 17:32:26,650 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 17:32:26,650 - weights are [1, 1, 1, 3]
2021-04-01 17:32:29,748 - 	 13.01621 0.00030
2021-04-01 17:33:00,853 - 	 13.68348 0.00030
2021-04-01 17:33:31,079 - 	 11.47769 0.00030
2021-04-01 17:34:00,206 - 	 11.01200 0.00030
2021-04-01 17:34:01,758 - 
 ---------------------- mean loss : 14.24804  ---------------------- 

2021-04-01 17:34:01,759 - Starting Validation
2021-04-01 17:34:17,901 - 
                     ------- validation -------            

2021-04-01 17:34:17,902 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:34:17,902 - 	 1.9256  	 0.2390  	 0.0945 	 0.7899
2021-04-01 17:34:17,902 - -------------------------------
Validation Epoch: 4 	Accuracy: 1005.0000	Loss: 791.216939
------------------
2021-04-01 17:34:17,930 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:34:17,931 - Best model updated in 'st_lr_3e-4.ini'! !!!!!!!!!
2021-04-01 17:34:17,931 - #### End epoch 4/1000, elapsed time: 111.28120168764144
2021-04-01 17:34:17,931 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 17:34:17,931 - weights are [1, 1, 1, 3]
2021-04-01 17:34:20,795 - 	 12.62297 0.00030
2021-04-01 17:34:51,684 - 	 11.38001 0.00030
2021-04-01 17:35:21,596 - 	 10.44341 0.00030
2021-04-01 17:35:50,729 - 	 10.05546 0.00030
2021-04-01 17:35:52,222 - 
 ---------------------- mean loss : 12.89289  ---------------------- 

2021-04-01 17:35:52,222 - Starting Validation
2021-04-01 17:36:08,165 - 
                     ------- validation -------            

2021-04-01 17:36:08,166 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:36:08,166 - 	 1.7387  	 0.1757  	 0.0884 	 0.5155
2021-04-01 17:36:08,166 - -------------------------------
Validation Epoch: 5 	Accuracy: 1213.0000	Loss: 685.220594
------------------
2021-04-01 17:36:08,193 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:36:08,194 - Best model updated in 'st_lr_3e-4.ini'! !!!!!!!!!
2021-04-01 17:36:08,194 - #### End epoch 5/1000, elapsed time: 110.26308109611273
2021-04-01 17:36:08,194 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 17:36:08,194 - weights are [1, 1, 1, 3]
2021-04-01 17:36:11,114 - 	 10.66958 0.00030
2021-04-01 17:36:41,896 - 	 10.70494 0.00030
2021-04-01 17:37:11,709 - 	 9.69840 0.00030
2021-04-01 17:37:40,951 - 	 10.17535 0.00030
2021-04-01 17:37:42,492 - 
 ---------------------- mean loss : 12.55544  ---------------------- 

2021-04-01 17:37:42,492 - Starting Validation
2021-04-01 17:37:58,353 - 
                     ------- validation -------            

2021-04-01 17:37:58,353 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:37:58,354 - 	 1.5557  	 0.2251  	 0.0752 	 0.7631
2021-04-01 17:37:58,354 - -------------------------------
Validation Epoch: 6 	Accuracy: 1186.0000	Loss: 658.236621
------------------
2021-04-01 17:37:58,379 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:37:58,379 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-04-01 17:37:58,380 - #### End epoch 6/1000, elapsed time: 110.18532976228744
2021-04-01 17:37:58,380 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 17:37:58,380 - weights are [1, 1, 1, 3]
2021-04-01 17:38:01,453 - 	 8.86029 0.00030
2021-04-01 17:38:31,779 - 	 8.67365 0.00030
2021-04-01 17:39:01,980 - 	 11.44563 0.00030
2021-04-01 17:39:31,296 - 	 9.64317 0.00030
2021-04-01 17:39:32,790 - 
 ---------------------- mean loss : 12.28465  ---------------------- 

2021-04-01 17:39:32,790 - Starting Validation
2021-04-01 17:39:48,890 - 
                     ------- validation -------            

2021-04-01 17:39:48,890 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:39:48,890 - 	 1.4651  	 0.1419  	 0.0604 	 0.4149
2021-04-01 17:39:48,890 - -------------------------------
Validation Epoch: 7 	Accuracy: 1453.0000	Loss: 572.418968
------------------
2021-04-01 17:39:48,921 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:39:48,922 - Best model updated in 'st_lr_3e-4.ini'! !!!!!!!!!
2021-04-01 17:39:48,922 - #### End epoch 7/1000, elapsed time: 110.54240432009101
2021-04-01 17:39:48,922 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 17:39:48,922 - weights are [1, 1, 1, 3]
2021-04-01 17:39:51,719 - 	 10.08589 0.00030
2021-04-01 17:40:22,582 - 	 10.20510 0.00030
2021-04-01 17:40:52,422 - 	 10.73192 0.00030
2021-04-01 17:41:21,521 - 	 8.67299 0.00030
2021-04-01 17:41:23,005 - 
 ---------------------- mean loss : 11.28304  ---------------------- 

2021-04-01 17:41:23,005 - Starting Validation
2021-04-01 17:41:39,017 - 
                     ------- validation -------            

2021-04-01 17:41:39,017 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:41:39,018 - 	 1.4446  	 0.1483  	 0.0468 	 0.4699
2021-04-01 17:41:39,018 - -------------------------------
Validation Epoch: 8 	Accuracy: 1438.0000	Loss: 571.523929
------------------
2021-04-01 17:41:39,044 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:41:39,045 - model got improved for this run, but did not surpass previous though, please take changes of hyper parameters into consideration
2021-04-01 17:41:39,045 - #### End epoch 8/1000, elapsed time: 110.12255722749978
2021-04-01 17:41:39,045 - 
 --------------------------- epoch 9 ------------------------- 

2021-04-01 17:41:39,045 - weights are [1, 1, 1, 3]
2021-04-01 17:41:42,153 - 	 10.05115 0.00030
2021-04-01 17:42:57,864 - 	 9.19953 0.00030
2021-04-01 17:44:46,452 - 	 8.99675 0.00030
2021-04-01 17:46:47,580 - 	 8.88624 0.00030
2021-04-01 17:46:57,918 - 
 ---------------------- mean loss : 11.25139  ---------------------- 

2021-04-01 17:46:57,919 - Starting Validation
2021-04-01 17:47:21,950 - 
                     ------- validation -------            

2021-04-01 17:47:21,951 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 17:47:21,951 - 	 1.2979  	 0.1416  	 0.0381 	 0.4434
2021-04-01 17:47:21,951 - -------------------------------
Validation Epoch: 9 	Accuracy: 1587.0000	Loss: 516.408535
------------------
2021-04-01 17:47:21,983 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/st_lr_3e-4-2021-04-01_17_26_49-model_best.pth

2021-04-01 17:47:21,983 - Best model updated in 'st_lr_3e-4.ini'! !!!!!!!!!
2021-04-01 17:47:21,983 - #### End epoch 9/1000, elapsed time: 342.9387059099972
2021-04-01 17:47:21,984 - 
 --------------------------- epoch 10 ------------------------- 

2021-04-01 17:47:21,984 - weights are [1, 1, 1, 3]
2021-04-01 17:47:25,812 - 	 9.53160 0.00030
2021-04-01 17:49:14,938 - 	 8.58325 0.00030
2021-04-01 17:51:16,961 - 	 8.04295 0.00030
