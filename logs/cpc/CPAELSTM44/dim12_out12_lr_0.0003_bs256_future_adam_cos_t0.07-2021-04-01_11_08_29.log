2021-04-01 11:08:29,366 - ===> use benchmark strategy to split train, validation and eval dataset
2021-04-01 11:08:30,887 - ### Model summary below###
 CPAELSTM44(
  (lstm1): LSTM(76, 12, batch_first=True)
  (lstm2): LSTM(12, 12, batch_first=True)
  (lstm3): LSTM(12, 12, batch_first=True)
  (dropout): Dropout(p=0.3, inplace=False)
  (softmax): Softmax(dim=0)
  (lsoftmax): LogSoftmax()
  (fcs): Sequential(
    (0): Linear(in_features=12, out_features=12, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=12, out_features=12, bias=True)
  )
  (lstm4): LSTM(12, 76, batch_first=True)
  (W_pred): Linear(in_features=12, out_features=12, bias=True)
)

2021-04-01 11:08:30,888 - ===> Model total parameter: 34644

2021-04-01 11:08:30,888 - {'data_split': 'benchmark', 'batch_size': 256, 'mode': 0, 'dim': 12, 'bn': False, 'dropout': 0.3, 'task': 'ihm', 'learning_rate': 0.0003, 'epochs': 1000, 'seed': 1, 'log_interval': 5, 'num_workers': 30, 'gru_out': 12, 'sim': 'cosine', 'temperature': 0.07, 'optimizer': 'optim.Adam(filter(lambda p: p.requires_grad, model.parameters()), lr=0.0003, betas=(0.9, 0.98), eps=1e-09,weight_decay=1e-4)', 'adjust_lr': True, 'setting_name': 'dim12_out12_lr_0.0003_bs256_future_adam_cos_t0.07', 'run_name': 'dim12_out12_lr_0.0003_bs256_future_adam_cos_t0.07-2021-04-01_11_08_29', 'model_type': 'CPAELSTM44', 'resume': False, 'model_best': 'dim12_out12_lr_0.03_bs256_ts30_sgd_cos_t0.07-2021-04-01_09_30_46-model_best.pth', 'save_every': 100, 'lambda': [1, 1, 1, 3], 'time_step': 30, 'sym': False, 'top_path': '/home/shuying/CPAE/', 'scr_data_path': '/home/shuying/cpcSurvival/data', 'logging_dir': '/home/shuying/CPAE/logs/cpc/CPAELSTM44', 'ini_file': '/home/shuying/CPAE/logs/cpc/CPAELSTM44/dim12_out12_lr_0.0003_bs256_future_adam_cos_t0.07.ini', 'updated_lr': 0.03, 'pred_mode': 'future', 't_range': (0.5, 0.7)}
2021-04-01 11:08:30,888 - 
 --------------------------- epoch 1 ------------------------- 

2021-04-01 11:08:30,888 - weights are [1, 1, 1, 3]
2021-04-01 11:08:50,391 - 	 28.64193 0.00030
2021-04-01 11:10:50,105 - 
 ---------------------- mean loss : 30.69480  ---------------------- 

2021-04-01 11:10:50,105 - Starting Validation
2021-04-01 11:11:07,266 - 
                     ------- validation -------            

2021-04-01 11:11:07,266 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:11:07,266 - 	 5.5041  	 0.2668  	 0.1117 	 0.6683
2021-04-01 11:11:07,266 - -------------------------------
Validation Epoch: 1 	Accuracy: 13.0000	Loss: 381.513222
------------------
2021-04-01 11:11:07,270 - Snapshot saved to /home/shuying/CPAE/logs/cpc/CPAELSTM44/dim12_out12_lr_0.0003_bs256_future_adam_cos_t0.07-2021-04-01_11_08_29-model_best.pth

2021-04-01 11:11:07,271 - Best model updated in 'dim12_out12_lr_0.0003_bs256_future_adam_cos_t0.07.ini'! !!!!!!!!!
2021-04-01 11:11:07,271 - #### End epoch 1/1000, elapsed time: 156.3831642139703
2021-04-01 11:11:07,271 - 
 --------------------------- epoch 2 ------------------------- 

2021-04-01 11:11:07,271 - weights are [1, 1, 1, 3]
2021-04-01 11:11:30,716 - 	 28.51774 0.00030
2021-04-01 11:13:22,113 - 
 ---------------------- mean loss : 29.88586  ---------------------- 

2021-04-01 11:13:22,114 - Starting Validation
2021-04-01 11:13:39,486 - 
                     ------- validation -------            

2021-04-01 11:13:39,486 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:13:39,486 - 	 5.5041  	 0.2295  	 0.1031 	 0.5457
2021-04-01 11:13:39,486 - -------------------------------
Validation Epoch: 2 	Accuracy: 13.0000	Loss: 377.617365
------------------
2021-04-01 11:13:39,486 - #### End epoch 2/1000, elapsed time: 152.2153734592721
2021-04-01 11:13:39,486 - 
 --------------------------- epoch 3 ------------------------- 

2021-04-01 11:13:39,486 - weights are [1, 1, 1, 3]
2021-04-01 11:13:57,768 - 	 41.09856 0.00030
2021-04-01 11:15:58,440 - 
 ---------------------- mean loss : 29.96760  ---------------------- 

2021-04-01 11:15:58,442 - Starting Validation
2021-04-01 11:16:14,633 - 
                     ------- validation -------            

2021-04-01 11:16:14,633 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:16:14,634 - 	 5.5041  	 0.3077  	 0.1036 	 0.9360
2021-04-01 11:16:14,634 - -------------------------------
Validation Epoch: 3 	Accuracy: 13.0000	Loss: 388.794298
------------------
2021-04-01 11:16:14,634 - #### End epoch 3/1000, elapsed time: 155.1474723983556
2021-04-01 11:16:14,634 - 
 --------------------------- epoch 4 ------------------------- 

2021-04-01 11:16:14,634 - weights are [1, 1, 1, 3]
2021-04-01 11:16:37,547 - 	 28.49338 0.00030
2021-04-01 11:18:30,831 - 
 ---------------------- mean loss : 29.83395  ---------------------- 

2021-04-01 11:18:30,831 - Starting Validation
2021-04-01 11:18:47,967 - 
                     ------- validation -------            

2021-04-01 11:18:47,967 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:18:47,967 - 	 5.5041  	 0.2606  	 0.1028 	 0.6915
2021-04-01 11:18:47,967 - -------------------------------
Validation Epoch: 4 	Accuracy: 13.0000	Loss: 381.803585
------------------
2021-04-01 11:18:47,967 - #### End epoch 4/1000, elapsed time: 153.3335039401427
2021-04-01 11:18:47,968 - 
 --------------------------- epoch 5 ------------------------- 

2021-04-01 11:18:47,968 - weights are [1, 1, 1, 3]
2021-04-01 11:19:04,249 - 	 28.47374 0.00030
2021-04-01 11:21:38,476 - 
 ---------------------- mean loss : 29.71979  ---------------------- 

2021-04-01 11:21:38,476 - Starting Validation
2021-04-01 11:21:56,519 - 
                     ------- validation -------            

2021-04-01 11:21:56,519 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:21:56,519 - 	 5.5041  	 0.2214  	 0.1014 	 0.5262
2021-04-01 11:21:56,519 - -------------------------------
Validation Epoch: 5 	Accuracy: 13.0000	Loss: 376.960112
------------------
2021-04-01 11:21:56,519 - #### End epoch 5/1000, elapsed time: 188.55183189269155
2021-04-01 11:21:56,519 - 
 --------------------------- epoch 6 ------------------------- 

2021-04-01 11:21:56,519 - weights are [1, 1, 1, 3]
2021-04-01 11:22:10,907 - 	 29.59169 0.00030
2021-04-01 11:24:49,161 - 
 ---------------------- mean loss : 30.06290  ---------------------- 

2021-04-01 11:24:49,162 - Starting Validation
2021-04-01 11:25:05,590 - 
                     ------- validation -------            

2021-04-01 11:25:05,590 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:25:05,590 - 	 5.5041  	 0.2384  	 0.1020 	 0.6068
2021-04-01 11:25:05,590 - -------------------------------
Validation Epoch: 6 	Accuracy: 13.0000	Loss: 379.293081
------------------
2021-04-01 11:25:05,591 - #### End epoch 6/1000, elapsed time: 189.07127401884645
2021-04-01 11:25:05,591 - 
 --------------------------- epoch 7 ------------------------- 

2021-04-01 11:25:05,591 - weights are [1, 1, 1, 3]
2021-04-01 11:25:27,026 - 	 28.41272 0.00030
2021-04-01 11:27:57,114 - 
 ---------------------- mean loss : 29.94487  ---------------------- 

2021-04-01 11:27:57,116 - Starting Validation
2021-04-01 11:28:13,953 - 
                     ------- validation -------            

2021-04-01 11:28:13,953 - 	 NCE 	 MSE 	 MASK MSE 	 MAPPING MSE
2021-04-01 11:28:13,953 - 	 5.5041  	 0.2273  	 0.1001 	 0.5947
2021-04-01 11:28:13,953 - -------------------------------
Validation Epoch: 7 	Accuracy: 13.0000	Loss: 378.784863
------------------
2021-04-01 11:28:13,953 - #### End epoch 7/1000, elapsed time: 188.362500064075
2021-04-01 11:28:13,953 - 
 --------------------------- epoch 8 ------------------------- 

2021-04-01 11:28:13,953 - weights are [1, 1, 1, 3]
2021-04-01 11:28:24,659 - 	 28.64980 0.00030
2021-04-01 11:31:01,022 - 
 ---------------------- mean loss : 29.59141  ---------------------- 

2021-04-01 11:31:01,023 - Starting Validation
